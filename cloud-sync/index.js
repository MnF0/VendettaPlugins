(function(g,Se,B,C,_,O,E,l,z,n,y,f,h,j,Re,Ee,ve){"use strict";const{TextStyleSheet:we}=f.findByProps("TextStyleSheet"),{View:m,Text:V,Pressable:Te}=y.General,{FormRow:be}=y.Forms;f.find(function(e){return e.render?.name==="ActionSheet"}),f.findByProps("openLazy","hideActionSheet"),f.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer");function Ce(e){const t=f.findByProps("colors","meta"),a=f.findByStoreName("ThemeStore");return t.meta.resolveSemanticColor(a.theme,e)}function Ie(e){let{title:t,onPress:a,icon:i}=e;const o=n.stylesheet.createThemedStyleSheet({androidRipple:{color:h.semanticColors.ANDROID_RIPPLE},mainText:{fontFamily:n.constants.Fonts.PRIMARY_SEMIBOLD,fontSize:14,includeFontPadding:!1,letterSpacing:void 0,lineHeight:18,textTransform:"none",color:h.semanticColors.HEADER_SECONDARY},icon:{height:14,tintColor:h.semanticColors.HEADER_SECONDARY}}),r=a?Te:m;return n.React.createElement(r,{android_ripple:o.androidRipple,disabled:!1,accessibilityRole:"button",onPress:a,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},i&&n.React.createElement(m,{style:{marginRight:4}},n.React.createElement(be.Icon,{style:o.icon,source:i,size:"small"})),n.React.createElement(V,{style:o.mainText},t))}function k(e){let{title:t,onTitlePress:a,icon:i,children:o,padding:r}=e;const u=n.stylesheet.createThemedStyleSheet({main:{backgroundColor:h.semanticColors.BACKGROUND_TERTIARY,borderRadius:16,overflow:"hidden",flex:1}});return n.React.createElement(m,{style:{marginHorizontal:16,marginTop:16}},n.React.createElement(Ie,{title:t,onPress:a,icon:i}),n.React.createElement(m,{style:u.main},r?n.React.createElement(m,{style:{paddingHorizontal:16,paddingVertical:16}},o):o))}function me(e){let{addPadding:t}=e;const a=n.stylesheet.createThemedStyleSheet({line:{width:"100%",height:2,backgroundColor:h.semanticColors.BACKGROUND_ACCENT,borderRadius:2147483647}});return n.React.createElement(m,{style:[{marginTop:16,marginBottom:16},t&&{marginHorizontal:16}]},n.React.createElement(m,{style:a.line}))}var q;(function(e){function t(i){let{children:o,onPress:r}=i;return n.React.createElement(Ne,{variant:"text-md/bold",onPress:r},o)}e.Bold=t;function a(i){let{children:o,onPress:r}=i;return n.React.createElement(V,{style:{textDecorationLine:"underline"},onPress:r},o)}e.Underline=a})(q||(q={}));function Ne(e){let{variant:t,lineClamp:a,color:i,align:o,style:r,onPress:u,getChildren:d,children:c,liveUpdate:T}=e;const[b,v]=n.React.useReducer(function(R){return~R},0);return n.React.useEffect(function(){if(!T)return;const R=new Date().setMilliseconds(1e3);let w,I;return I=setTimeout(function(){v(),w=setInterval(v,1e3)},R-Date.now()),function(){clearTimeout(I),clearInterval(w)}},[]),n.React.createElement(V,{style:[t?we[t]:{},i?{color:Ce(h.semanticColors[i])}:{},o?{textAlign:o}:{},r??{}],numberOfLines:a,onPress:u},d?.()??c)}function Q(e){let{onPress:t,icon:a,style:i,destructive:o}=e;const r=n.stylesheet.createThemedStyleSheet({headerStyleIcon:{width:24,height:24,marginRight:10,tintColor:h.semanticColors.HEADER_PRIMARY},cardStyleIcon:{width:22,height:22,marginLeft:5,tintColor:h.semanticColors.INTERACTIVE_NORMAL},destructiveIcon:{tintColor:h.semanticColors.TEXT_DANGER}});return n.React.createElement(n.ReactNative.TouchableOpacity,{onPress:t},n.React.createElement(n.ReactNative.Image,{style:[typeof i=="string"?i==="header"?r.headerStyleIcon:r.cardStyleIcon:i,o&&r.destructiveIcon].filter(function(u){return!!u}),source:a}))}const{View:Pe,Text:Z}=y.General,{TextStyleSheet:ee}=f.findByProps("TextStyleSheet"),te=n.stylesheet.createThemedStyleSheet({count:{...ee["text-lg/bold"],color:h.semanticColors.TEXT_NORMAL,textAlign:"center"},subtitle:{...ee["text-md/medium"],color:h.semanticColors.TEXT_MUTED,textAlign:"center"}});function ne(e){let{subtitle:t,count:a,contents:i}=e;return React.createElement(Pe,{style:{alignItems:"center",justifyContent:"center",marginHorizontal:16}},React.createElement(Z,{style:te.count},a),React.createElement(Z,{style:te.subtitle},t))}const ae="https://vd-cloudsync.nexpid.workers.dev/";var N={unproxiedURL:"https://vendetta.nexpid.xyz/cloud-sync",api:ae,oauth2:{clientId:"1120793656878714913",redirectURL:`${ae}api/oauth2-response`}};function Ae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function De(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t,a){return ie()?U=Reflect.construct:U=function(i,o,r){var u=[null];u.push.apply(u,o);var d=Function.bind.apply(i,u),c=new d;return r&&x(c,r.prototype),c},U.apply(null,arguments)}function $(e){return $=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},$(e)}function Be(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}function _e(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function Oe(e,t){return t&&($e(t)==="object"||typeof t=="function")?t:Ae(e)}function x(e,t){return x=Object.setPrototypeOf||function(a,i){return a.__proto__=i,a},x(e,t)}function $e(e){"@swc/helpers - typeof";return e&&typeof Symbol<"u"&&e.constructor===Symbol?"symbol":typeof e}function G(e){var t=typeof Map=="function"?new Map:void 0;return G=function(a){if(a===null||!_e(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(a))return t.get(a);t.set(a,i)}function i(){return U(a,arguments,$(this).constructor)}return i.prototype=Object.create(a.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),x(i,a)},G(e)}function ie(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xe(e){var t=ie();return function(){var a=$(e),i;if(t){var o=$(this).constructor;i=Reflect.construct(a,arguments,o)}else i=a.apply(this,arguments);return Oe(this,i)}}let F=function(e){Be(a,e);var t=xe(a);function a(i){De(this,a);var o;return o=t.call(this,`${i.status}: ${i.message}${i.error?` (${i.error})`:""}`),o.name=o.constructor.name,o}return a}(G(Error));async function Me(e){const t=await fetch(`${N.api}api/oauth2-response?code=${encodeURIComponent(e)}&vendetta=true`);if(t.status===200)return await t.text();throw new F(await t.json())}async function Le(){if(!s.authorization)return;const e=await fetch(`${N.api}api/get-data`,{headers:{authorization:s.authorization}});if(e.status===200)return await e.json();throw new F(await e.json())}async function re(e){if(!s.authorization)return;const t=await fetch(`${N.api}api/sync-data`,{method:"POST",headers:{authorization:s.authorization,"content-type":"application/json"},body:JSON.stringify(e)});if(t.status===200)return await t.json();throw new F(await t.json())}async function ke(){if(!s.authorization)return;const e=await fetch(`${N.api}api/delete-data`,{method:"DELETE",headers:{authorization:s.authorization}});if(e.status===200)return await e.json();throw new F(await e.json())}const{pushModal:Ue,popModal:Fe}=f.findByProps("pushModal","popModal"),ze=f.findByName("OAuth2AuthorizeModal");function je(){Ue({key:"oauth2-authorize",modal:{key:"oauth2-authorize",modal:ze,animation:"slide-up",shouldPersistUnderModals:!1,props:{clientId:N.oauth2.clientId,redirectUri:N.oauth2.redirectURL,scopes:["identify"],responseType:"code",permissions:0n,cancelCompletesFlow:!1,callback:async function(e){let{location:t}=e;try{const a=new URL(t).searchParams.get("code"),i=await Me(a);s.authorization=i,K(),E.showToast("Successfully authenticated",l.getAssetIDByName("Check"))}catch(a){E.showToast(a?.message??a?.toString()??"An error occured during authentication",l.getAssetIDByName("Small"))}},dismissOAuthModal:function(){return Fe("oauth2-authorize")}},closable:!0}})}const Ve=window.nativeModuleProxy.BundleUpdaterManager;async function oe(){const e={themes:[],plugins:[]};for(const t of Object.values(_.plugins)){const a=s.pluginSettings[t.id];if(a?.syncPlugin===!1)continue;const i=a?.syncStorage===!1?{}:await B.createMMKVBackend(t.id).get();e.plugins.push({id:t.id,enabled:t.enabled,options:i})}for(const t of Object.values(O.themes))e.themes.push({id:t.id,enabled:t.selected});return e}async function Ge(e){if(!S.save)return;let t=!1;const a=S.save.sync.plugins.filter(function(c){return!Object.keys(_.plugins).includes(c.id)&&!c.id.includes("cloud-sync")}),i=a.filter(function(c){return!X(c.id)});let o=!0;i[0]&&await M(!0,"Unproxied Plugins",`Do you want to install **${i.length}** unproxied plugin${i.length!==1?"s":""}? Unproxied plugins haven't been verified by Vendetta staff and thus possibly dangerous. Are you sure you want to continue?`,"Proceed","Skip",void 0,async function(){o=!1});const r=a.filter(function(c){return o?!0:X(c.id)});r.length>0&&await M(e,"Install Plugins",`Would you like to install **${r.length}** new plugin${r.length!==1?"s":""}?`,"Yes","No",async function(){t=!0;for(const c of a)B.createMMKVBackend(c.id).set(c.options),await _.installPlugin(c.id,c.enabled);E.showToast("Synced plugins",l.getAssetIDByName("Check"))});let u;const d=S.save.sync.themes.filter(function(c){return!Object.keys(O.themes).includes(c.id)});d.length>0&&await M(e,"Install Themes",`Would you like to install **${d.length}** new theme${d.length!==1?"s":""}?`,"Yes","No",async function(){t=!0;for(const c of d)c.enabled&&(u=c.id),await O.installTheme(c.id);E.showToast("Synced themes",l.getAssetIDByName("Check"))}),u&&await M(e,"Reload Required","A reload is required to apply the theme. Would you like to reload?","Reload","Skip",async function(){await O.fetchTheme(u,!0),Ve.reload()}),t||E.showToast("Nothing to sync",l.getAssetIDByName("ic_sync_24px"))}const ce=f.findByProps("isTablet"),{Text:He,View:Ye}=y.General,{FormRow:Ke}=y.Forms,{TextStyleSheet:se}=f.findByProps("TextStyleSheet"),le=n.stylesheet.createThemedStyleSheet({text:{...se["text-md/medium"],color:h.semanticColors.TEXT_NORMAL},button:{...se["text-md/medium"],color:h.semanticColors.TEXT_NORMAL,borderRadius:8}});function Xe(){const[e,t]=n.React.useState({});return s.authorization?n.React.createElement(Ye,{style:{flexDirection:ce.isTablet?"row":"column",justifyContent:"flex-end"}},[{text:"Sync Data",onPress:async function(a){a(!0);try{S.save=await re(await oe()),A(),E.showToast("Successfully synced data",l.getAssetIDByName("Check"))}catch(i){E.showToast(`Failed to sync data: ${i}`,l.getAssetIDByName("Small"))}a(!1)}},{text:"Load Data",onPress:async function(a){a(!0);try{await Ge(!0)}catch(i){console.log("ZOINKS",i)}a(!1)}}].map(function(a,i){const o=i!==0?8:0;return n.React.createElement(y.Button,{text:a.text,color:"green",size:"small",onPress:function(){return!e[i]&&a.onPress(function(r){t({...e,[i]:!!r})})},trailing:n.React.createElement(Ke.Icon,{source:l.getAssetIDByName("Check")}),loading:e[i],style:{...le.button,...ce.isTablet?{marginLeft:o}:{marginTop:o}}})})):n.React.createElement(He,{style:{...le.text,textAlign:"center"}},"Authenticate first to manage your data")}const{FormSwitchRow:ue}=y.Forms;function Je(){const[e,t]=n.React.useState(""),[,a]=n.React.useReducer(function(r){return~r},0);n.React.useEffect(function(){t("")},[]),B.useProxy(s);const i=n.NavigationNative.useNavigation(),o=i.addListener("focus",function(){o(),i.setOptions({title:"Plugin Settings",headerRight:function(){return n.React.createElement(Q,{onPress:function(){return z.showConfirmationAlert({title:"Revert Settings",content:"Are you sure you want to revert all plugin settings?",confirmText:"Revert",cancelText:"Cancel",confirmColor:"red",onConfirm:function(){return s.pluginSettings={}}})},icon:l.getAssetIDByName("ic_message_delete"),style:"header"})}})});return n.React.createElement(n.ReactNative.FlatList,{ListHeaderComponent:n.React.createElement(y.Search,{style:{marginBottom:10},onChangeText:function(r){return t(r.toLowerCase())}}),style:{paddingHorizontal:10,paddingTop:10},contentContainerStyle:{paddingBottom:20},data:Object.entries(_.plugins).filter(function(r){return r[1].manifest.name?.toLowerCase().includes(e)}),renderItem:function(r){let{item:[u,d]}=r;const c=s.pluginSettings[u]??{syncPlugin:!0,syncStorage:!0},T=function(){c.syncPlugin===!0&&c.syncStorage===!0?delete s.pluginSettings[u]:s.pluginSettings[u]=c,a()};return n.React.createElement(y.Summary,{label:d.manifest.name,icon:d.manifest.vendetta.icon??":3"},n.React.createElement(ue,{label:"Sync Plugin",onValueChange:function(){c.syncPlugin=!c.syncPlugin,T()},value:c.syncPlugin}),n.React.createElement(ue,{label:"Sync Plugin Storage",onValueChange:function(){c.syncStorage=!c.syncStorage,T()},value:c.syncStorage}))}})}var de={github:{url:"https://github.com/Gabe616/VendettaPlugins/"}};const{showSimpleActionSheet:We}=f.findByProps("showSimpleActionSheet"),qe=f.findByStoreName("UserStore");function Qe(){const e=ve.getDebugInfo(),t=n.ReactNative.NativeModules.InfoDictionaryManager??n.ReactNative.NativeModules.RTNClientInfoManager;return`Device: ${e.os.name==="iOS"?e.device.codename:`${e.device.brand} ${e.device.model}`}
Model: ${e.device.model}
Manufacturer: ${e.device.manufacturer}
Brand: ${e.device.brand}

OS: ${e.os.name}
Version: ${e.os.version}

Discord Branch: ${t.ReleaseChannel}
Discord Version: ${e.discord.version}
Discord Build: ${e.discord.build}
Vendetta Version: ${e.vendetta.version}

React Version: ${e.react.version}
Hermes Bytecode: ${e.hermes.bytecodeVersion}`}function fe(e){const t=qe.getCurrentUser(),a=new URLSearchParams;for(const[i,o]of Object.entries(e))a.set(i,o);return a.set("discord-username",`@${t.username}${t.discriminator!=="0"?`#${t.discriminator}`:""}`),console.log(`${de.github.url}issues/new?${a.toString()}`),`${de.github.url}issues/new?${a.toString()}`}const Ze=function(e){return We({key:"CardOverflow",header:{title:"GitHub Reports"},options:[{label:"Copy bug report link",icon:l.getAssetIDByName("copy"),onPress:function(){n.clipboard.setString(fe({title:`bug(${e}): `,template:"bug_report.yml",labels:"bug",sysinfo:Qe()})),E.showToast("Copied",l.getAssetIDByName("toast_copy_link"))}},{label:"Copy feature suggestion link",icon:l.getAssetIDByName("copy"),onPress:function(){n.clipboard.setString(fe({title:`suggest(${e}): `,labels:"suggestion",template:"suggestion.yml"})),E.showToast("Copied",l.getAssetIDByName("toast_copy_link"))}}]})},{ScrollView:et,View:tt}=y.General,{FormRow:p,FormSwitchRow:ge}=y.Forms;function H(){const[,e]=n.React.useReducer(function(i){return~i},0);B.useProxy(s),g.cacheUpd.push(e),n.React.useEffect(function(){return function(){g.cacheUpd=g.cacheUpd.filter(function(i){return i!==e})}},[]);const t=n.NavigationNative.useNavigation(),a=t.addListener("focus",function(){a(),t.setOptions({headerRight:function(){return n.React.createElement(Q,{icon:l.getAssetIDByName("ic_report_message"),style:"header",onPress:function(){return Ze("cloud-sync")}})}})});return n.React.createElement(et,null,n.React.createElement(k,{title:"Current Data",icon:l.getAssetIDByName("ic_contact_sync"),padding:!0},n.React.createElement(tt,{style:{flexDirection:"row",alignItems:"center",justifyContent:"center",marginVertical:8}},n.React.createElement(ne,{count:S.save?.sync?.plugins?.length??"-",subtitle:"plugins",contents:2}),n.React.createElement(ne,{count:S.save?.sync?.themes?.length??"-",subtitle:"themes",contents:2}))),n.React.createElement(k,{title:"Settings",icon:l.getAssetIDByName("ic_cog_24px")},n.React.createElement(ge,{label:"Auto Sync",subLabel:"Automatically sync data to cloud",leading:n.React.createElement(p.Icon,{source:l.getAssetIDByName("ic_contact_sync")}),onValueChange:function(){return s.autoSync=!s.autoSync},value:s.autoSync}),n.React.createElement(ge,{label:"Pin To Settings",subLabel:"Pin Cloud Sync to the settings page",leading:n.React.createElement(p.Icon,{source:l.getAssetIDByName("ic_message_pin")}),onValueChange:function(){return s.addToSettings=!s.addToSettings},value:s.addToSettings}),n.React.createElement(p,{label:"Plugin Settings",leading:n.React.createElement(p.Icon,{source:l.getAssetIDByName("debug")}),trailing:n.React.createElement(p.Arrow,null),onPress:function(){return t.push("VendettaCustomPage",{render:Je})}})),n.React.createElement(k,{title:"Authentication",icon:l.getAssetIDByName("lock")},s.authorization?n.React.createElement(n.React.Fragment,null,n.React.createElement(p,{label:"Log out",subLabel:"Logs you out of CloudSync",leading:n.React.createElement(p.Icon,{source:l.getAssetIDByName("ic_logout_24px")}),onPress:function(){delete s.authorization,delete S.save,A(),E.showToast("Successfully logged out",l.getAssetIDByName("ic_logout_24px"))}}),n.React.createElement(p,{label:"Delete data",subLabel:"Deletes your data and logs you out of CloudSync",leading:n.React.createElement(p.Icon,{source:l.getAssetIDByName("trash")}),onPress:async function(){await ke(),delete s.authorization,delete S.save,A(),E.showToast("Successfully deleted data",l.getAssetIDByName("trash"))}})):n.React.createElement(p,{label:"Authenticate",leading:n.React.createElement(p.Icon,{source:l.getAssetIDByName("copy")}),trailing:p.Arrow,onPress:je})),n.React.createElement(k,{title:"Data Management",icon:l.getAssetIDByName("ic_message_edit"),padding:!0},n.React.createElement(Xe,null),s.authorization&&n.React.createElement(n.React.Fragment,null,n.React.createElement(me,null),n.React.createElement(p,{label:"Copy Data as JSON",leading:n.React.createElement(p.Icon,{source:l.getAssetIDByName("copy")}),onPress:function(){n.clipboard.setString(JSON.stringify(S.save??{},void 0,3)),E.showToast("Copied",l.getAssetIDByName("Check"))}}))))}let ye=0;function nt(e){clearTimeout(ye),ye=setTimeout(e,1500)}const{FormRow:Y}=y.Forms;function at(){const e=n.NavigationNative.useNavigation();return React.createElement(y.ErrorBoundary,null,React.createElement(Y,{label:"Cloud Sync",leading:React.createElement(Y.Icon,{source:l.getAssetIDByName("ic_contact_sync")}),trailing:Y.Arrow,onPress:function(){return e.push("VendettaCustomPage",{title:"CloudSync",render:H})}}))}const{FormSection:it}=y.Forms,rt=f.findByName("getScreens"),ot=f.findByName("UserSettingsOverviewWrapper",!1),ct=f.findByName("SettingsOverviewScreen",!1),P=f.findByProps("SETTING_RELATIONSHIPS","SETTING_RENDERER_CONFIGS"),st=f.findByProps("getSettingTitleConfig"),lt=n.stylesheet.createThemedStyleSheet({container:{flex:1,backgroundColor:h.semanticColors.BACKGROUND_MOBILE_PRIMARY}});function ut(e,t,a){const i=[],o=C.after("default",ot,function(r,u){o();const d=j.findInReactTree(u.props.children,function(c){return c.type&&c.type.name==="UserSettingsOverview"});i.push(C.after("render",d.type.prototype,function(c,T){let{props:{children:b}}=T;const v=[n.i18n.Messages.BILLING_SETTINGS,n.i18n.Messages.PREMIUM_SETTINGS];b=j.findInReactTree(b,function(w){return w.children[1].type===it}).children;const R=b.findIndex(function(w){return v.includes(w?.props.label)});e()&&b.splice(R===-1?4:R,0,t())}))},!0);if(i.push(o),rt&&a){const r=`VENDETTA_PLUGIN_${n.lodash.snakeCase(a.key).toUpperCase()}`;i.push(C.after("default",ct,function(b,v){const R=v.props.sections,w=R.findIndex(function(I){return I.title==="Vendetta"});if(R[w]&&e()){const I={...R[w]};I.settings=[...I.settings,r],R[w]=I}})),i.push(C.after("getSettingTitleConfig",st,function(b,v){return{...v,...Object.fromEntries([[r,typeof a.title=="function"?a.title():a.title]])}}));const u=a.page.render,d=n.React.memo(function(b){let{navigation:v}=b;const R=v.addListener("focus",function(){R(),v.setOptions(j.without(a.page,"noErrorBoundary","render"))});return n.React.createElement(n.ReactNative.View,{style:lt.container},a.page.noErrorBoundary?n.React.createElement(u,null):n.React.createElement(y.ErrorBoundary,null,n.React.createElement(u,null)))}),c=P.SETTING_RELATIONSHIPS;P.SETTING_RELATIONSHIPS={...c,...Object.fromEntries([[r,null]])};const T=P.SETTING_RENDERER_CONFIGS;P.SETTING_RENDERER_CONFIGS={...T,...Object.fromEntries([[r,{type:"route",icon:a.icon,screen:{route:`VendettaPlugin${n.lodash.chain(a.key).camelCase().upperFirst().value()}`,getComponent:function(){return d}}}]])},i.push(function(){P.SETTING_RELATIONSHIPS=c,P.SETTING_RENDERER_CONFIGS=T})}return function(){return i.forEach(function(r){return r()})}}function dt(){let e=[];return e.push(ut(function(){return s.addToSettings},function(){return React.createElement(at,null)},{key:Re.plugin.manifest.name,icon:l.getAssetIDByName("ic_contact_sync"),title:"Cloud Sync",page:{title:"CloudSync",render:H}})),function(){return e.forEach(function(t){return t()})}}const s=Se.storage,S={};g.cacheUpd=[];function A(){g.cacheUpd.forEach(function(e){return e()})}async function K(){try{S.save=await Le()}catch{}A()}async function M(e,t,a,i,o,r,u){return e?new Promise(function(d){z.showConfirmationAlert({title:t,content:a,confirmText:i,cancelText:o,confirmColor:"green",isDismissable:!1,onConfirm:function(){return r?r().then(d):d()},onCancel:function(){return u?u().then(d):d()}})}):await r?.()}function X(e){return e.startsWith(Ee.PROXY_PREFIX)}const J=async function(){if(!s.autoSync)return;const e=await oe();JSON.stringify(S.save)!==JSON.stringify(e)&&nt(async function(){S.save=await re(e),A()})};let D=[],he=!1,W=!1;const pe=function(){D.push(C.after("createMMKVBackend",B,function(e,t){D.push(C.after("set",t,function(){return J()}))}))},L=2;s.autoSync??=!1,s.addToSettings??=!0,s.pluginSettings??={},n.FluxDispatcher.subscribe("I18N_LOAD_SUCCESS",function(){he=!0,W&&pe()});var ft={onLoad:function(){W=!0,s.authorization&&K(),["installPlugin","startPlugin","stopPlugin","removePlugin"].forEach(function(t){return D.push(C.after(t,_,function(){return J()}))}),["installTheme","selectTheme","removeTheme"].forEach(function(t){return D.push(C.after(t,O,function(){return J()}))}),he&&pe(),D.push(dt());const e=function(t,a){return z.showConfirmationAlert({title:t,content:a,onConfirm:function(){},confirmText:"Dismiss",confirmColor:"brand",secondaryConfirmText:"Don't show again",onConfirmSecondary:function(){return s.databaseMigrate=L}})};s.databaseMigrate!==L&&window.CSmigrationStage!==L&&(window.CSmigrationStage=L,e("Cloud Sync \u2014 DB Migration Stage 2",`CloudSync has officially switched to an SQLite database! (Cloudflare's D1) Make sure to sync your data again in case any was lost while migrating.

- nexx`))},onUnload:function(){W=!1,D.forEach(function(e){return e()})},settings:H};return g.cache=S,g.cacheUpdated=A,g.currentMigrationStage=L,g.default=ft,g.fillCache=K,g.isPluginProxied=X,g.promptOrRun=M,g.vstorage=s,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.plugin,vendetta.storage,vendetta.patcher,vendetta.plugins,vendetta.themes,vendetta.ui.toasts,vendetta.ui.assets,vendetta.ui.alerts,vendetta.metro.common,vendetta.ui.components,vendetta.metro,vendetta.ui,vendetta.utils,vendetta,vendetta.constants,vendetta.debug);
