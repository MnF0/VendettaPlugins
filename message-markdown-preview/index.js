(function(w,L,l,E,I,e,T,f,c,V,pe,z){"use strict";const{Animated:C}=e.ReactNative;function $(n){let{duration:r,children:i,style:a,fade:t,trigger:s,customOpacity:d,setDisplay:S,animateOnInit:y}=n;y??=!0;const b=e.React.useRef(!0),B=e.React.useRef(!0),p=e.React.useRef(new C.Value(y&&t==="in"?1:0)).current;return e.React.useEffect(function(){if(!y&&b.current){b.current=!1;return}!y&&B.current&&(p.setValue(t==="in"?0:1),B.current=!1),C.timing(p,{toValue:d??(t==="in"?1:0),duration:r,useNativeDriver:!0}).start()},[p,t,d,s]),e.React.createElement(C.View,{style:[{opacity:p},S&&p._value===0&&{display:"none"},a]},i)}const{ScrollView:F}=f.General,{default:G}=l.findByProps("DCDAutoModerationSystemMessageView","default"),U=l.findByName("MessageRecord"),k=l.findByName("RowManager"),D=l.findByStoreName("SelectedChannelStore"),N=l.findByStoreName("UserStore"),{receiveMessage:Y}=l.findByProps("receiveMessage"),{createBotMessage:j}=l.findByProps("createBotMessage"),{getText:K}=l.findByProps("openSystemKeyboard","getText");function x(){const n=K();if(n.trim()!=="")if(o.previewType==="popup")V.showConfirmationAlert({title:"Message Preview",onConfirm:function(){},children:React.createElement(F,{style:{marginVertical:12,maxHeight:e.ReactNative.Dimensions.get("window").height*.7}},React.createElement(G,{rowGenerator:new k,message:new U({id:"0",channel_id:D.getChannelId(),author:N.getCurrentUser(),content:n})}))});else{const r=D.getChannelId(),i=N.getCurrentUser();return Y(r,Object.assign(j({channelId:r,content:n}),{author:i}))}}const{Pressable:q,View:J}=f.General,g=40,P=e.stylesheet.createThemedStyleSheet({androidRipple:{color:c.semanticColors.ANDROID_RIPPLE,cornerRadius:2147483647},actionButton:{borderRadius:2147483647,height:g,width:g,marginHorizontal:4,flexShrink:0,flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:c.semanticColors.BACKGROUND_SECONDARY_ALT,marginLeft:8,marginTop:-4},actionIcon:{tintColor:c.semanticColors.INTERACTIVE_NORMAL,width:g*.6,height:g*.6}});function Q(n){let{inputProps:r}=n;const i=e.React.useRef(null);r.onChangeText?R.push(E.after("onChangeText",r,function(s){let[d]=s;return i.current=d},!0)):r.onChangeText=function(s){return i.current=s};const a=i.current?.length>0,t=a?q:J;return e.React.createElement($,{style:{flexDirection:"row",position:"absolute",left:0,top:-g,zIndex:3},duration:100,fade:a?"in":"out"},e.React.createElement(t,{android_ripple:P.androidRipple,disabled:!1,accessibilityRole:"button",accessibilityState:{disabled:!1,expanded:!1},accessibilityLabel:"Open markdown preview",accessibilityHint:"Open a modal which shows your message's markdown preview",onPress:a?function(){return x()}:void 0,style:P.actionButton},e.React.createElement(e.ReactNative.Image,{style:P.actionIcon,source:T.getAssetIDByName("ic_eye")})))}const{ChatInput:W}=l.findByProps("ChatInput"),X=l.findByTypeName("ChatInputActionButton"),R=[];function Z(){return R.push(E.after("render",W.prototype,function(n,r){const i=I.findInReactTree(r,function(t){return typeof t?.placeholder=="string"});if(!i?.onChangeText)return;const a=I.findInReactTree(r,function(t){return t?.type?.displayName==="View"&&Array.isArray(t?.props?.children)})?.props?.children;a&&o.buttonType==="pill"&&a.unshift(React.createElement(Q,{inputProps:i}))})),R.push(E.after("type",X,function(n,r){let[i]=n;i?.accessibilityLabel===e.i18n.Messages.SEND&&r.type?.render&&R.push(E.after("render",r.type,function(a,t){t.props&&(t.props.onLongPress=function(){return o.buttonType==="send"&&x()})},!0))})),function(){return R.forEach(function(n){return n()})}}const ee=l.findByStoreName("ThemeStore"),te=l.findByProps("colors","meta"),{TextStyleSheet:ne}=l.findByProps("TextStyleSheet"),{View:h,Text:m,Pressable:re}=f.General,{FormRow:ie}=f.Forms;l.find(function(n){return n.render?.name==="ActionSheet"}),l.findByProps("openLazy","hideActionSheet"),l.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer"),l.findByName("Navigator"),l.findByProps("getRenderCloseButton"),l.findByProps("popModal","pushModal");function ae(n){return te.meta.resolveSemanticColor(ee.theme,n)}function le(n){let{title:r,onPress:i,icon:a}=n;const t=e.stylesheet.createThemedStyleSheet({androidRipple:{color:c.semanticColors.ANDROID_RIPPLE},mainText:{fontFamily:e.constants.Fonts.PRIMARY_SEMIBOLD,fontSize:14,includeFontPadding:!1,letterSpacing:void 0,lineHeight:18,textTransform:"none",color:c.semanticColors.HEADER_SECONDARY},icon:{height:14,tintColor:c.semanticColors.HEADER_SECONDARY}}),s=i?re:h;return e.React.createElement(s,{android_ripple:t.androidRipple,disabled:!1,accessibilityRole:"button",onPress:i,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},a&&e.React.createElement(h,{style:{marginRight:4}},e.React.createElement(ie.Icon,{style:t.icon,source:a,size:"small"})),e.React.createElement(m,{style:t.mainText},r))}function oe(n){let{title:r,onTitlePress:i,icon:a,children:t,padding:s}=n;const d=e.stylesheet.createThemedStyleSheet({main:{backgroundColor:c.semanticColors.BACKGROUND_TERTIARY,borderRadius:16,overflow:"hidden",flex:1}});return e.React.createElement(h,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(le,{title:r,onPress:i,icon:a}),e.React.createElement(h,{style:d.main},s?e.React.createElement(h,{style:{paddingHorizontal:16,paddingVertical:16}},t):t))}var _;(function(n){function r(a){let{children:t,onPress:s}=a;return e.React.createElement(se,{variant:"text-md/bold",onPress:s},t)}n.Bold=r;function i(a){let{children:t,onPress:s}=a;return e.React.createElement(m,{style:{textDecorationLine:"underline"},onPress:s},t)}n.Underline=i})(_||(_={}));function se(n){let{variant:r,lineClamp:i,color:a,align:t,style:s,onPress:d,getChildren:S,children:y,liveUpdate:b}=n;const[B,p]=e.React.useReducer(function(A){return~A},0);return e.React.useEffect(function(){if(!b)return;const A=new Date().setMilliseconds(1e3);let O,H;return H=setTimeout(function(){p(),O=setInterval(p,1e3)},A-Date.now()),function(){clearTimeout(H),clearInterval(O)}},[]),e.React.createElement(m,{style:[r?ne[r]:{},a?{color:ae(c.semanticColors[a])}:{},t?{textAlign:t}:{},s??{}],numberOfLines:i,onPress:d},S?.()??y)}const{ScrollView:ce}=f.General,{FormRow:u,FormRadioRow:v}=f.Forms;function ue(){return o.buttonType??="pill",o.previewType??="popup",z.useProxy(o),React.createElement(ce,null,React.createElement(oe,{title:"Settings",icon:T.getAssetIDByName("ic_cog")},React.createElement(u,{label:"Button type",leading:React.createElement(u.Icon,{source:T.getAssetIDByName("ic_message_edit")})}),React.createElement(v,{label:"Floating Pill",onPress:function(){return o.buttonType="pill"},trailing:React.createElement(u.Arrow,null),selected:o.buttonType==="pill",style:{marginHorizontal:12}}),React.createElement(v,{label:"Send button",subLabel:"Holding the seld button",onPress:function(){return o.buttonType="send"},trailing:React.createElement(u.Arrow,null),selected:o.buttonType==="send",style:{marginHorizontal:12}}),React.createElement(u,{label:"Preview type",leading:React.createElement(u.Icon,{source:T.getAssetIDByName("ic_message_edit")})}),React.createElement(v,{label:"Popup",onPress:function(){return o.previewType="popup"},trailing:React.createElement(u.Arrow,null),selected:o.previewType==="popup",style:{marginHorizontal:12}}),React.createElement(v,{label:"Ephemeral message",onPress:function(){return o.previewType="clyde"},trailing:React.createElement(u.Arrow,null),selected:o.previewType==="clyde",style:{marginHorizontal:12}})))}const o=L.storage;let M;var de={onLoad:function(){return M=Z()},onUnload:function(){return M?.()},settings:ue};return w.default=de,w.vstorage=o,Object.defineProperty(w,"__esModule",{value:!0}),w})({},vendetta.plugin,vendetta.metro,vendetta.patcher,vendetta.utils,vendetta.metro.common,vendetta.ui.assets,vendetta.ui.components,vendetta.ui,vendetta.ui.alerts,vendetta.ui.toasts,vendetta.storage);
