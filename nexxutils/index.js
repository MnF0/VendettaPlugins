(function(p,Y,g,f,o,i,u,R,q,K){"use strict";const{TextStyleSheet:J}=o.findByProps("TextStyleSheet"),{View:v,Text:A,Pressable:Q}=u.General,{FormRow:Z}=u.Forms;o.find(function(t){return t.render?.name==="ActionSheet"}),o.findByProps("openLazy","hideActionSheet"),o.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer");function ee(t){const e=o.findByProps("colors","meta"),n=o.findByStoreName("ThemeStore");return e.meta.resolveSemanticColor(n.theme,t)}function te(t,e){const n=t.discriminator==="0";return t.avatar?`https://cdn.discordapp.com/avatars/${t.id}/${e&&t.avatar.startsWith("a_")?`${t.avatar}.gif`:`${t.avatar}.png`}`:`https://cdn.discordapp.com/embed/avatars/${n?(parseInt(t.id)>>22)%6:parseInt(t.discriminator)%5}`}function ne(t){let{title:e,onPress:n,icon:r}=t;const a=i.stylesheet.createThemedStyleSheet({androidRipple:{color:R.semanticColors.ANDROID_RIPPLE},mainText:{fontFamily:i.constants.Fonts.PRIMARY_SEMIBOLD,fontSize:14,includeFontPadding:!1,letterSpacing:void 0,lineHeight:18,textTransform:"none",color:R.semanticColors.HEADER_SECONDARY},icon:{height:14,tintColor:R.semanticColors.HEADER_SECONDARY}}),s=n?Q:v;return i.React.createElement(s,{android_ripple:a.androidRipple,disabled:!1,accessibilityRole:"button",onPress:n,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},r&&i.React.createElement(v,{style:{marginRight:4}},i.React.createElement(Z.Icon,{style:a.icon,source:r,size:"small"})),i.React.createElement(A,{style:a.mainText},e))}function ie(t){let{title:e,onTitlePress:n,icon:r,children:a,padding:s}=t;const l=i.stylesheet.createThemedStyleSheet({main:{backgroundColor:R.semanticColors.BACKGROUND_TERTIARY,borderRadius:16,overflow:"hidden",flex:1}});return i.React.createElement(v,{style:{marginHorizontal:16,marginTop:16}},i.React.createElement(ne,{title:e,onPress:n,icon:r}),i.React.createElement(v,{style:l.main},s?i.React.createElement(v,{style:{paddingHorizontal:16,paddingVertical:16}},a):a))}var C;(function(t){function e(r){let{children:a,onPress:s}=r;return i.React.createElement(b,{variant:"text-md/bold",onPress:s},a)}t.Bold=e;function n(r){let{children:a,onPress:s}=r;return i.React.createElement(A,{style:{textDecorationLine:"underline"},onPress:s},a)}t.Underline=n})(C||(C={}));function b(t){let{variant:e,lineClamp:n,color:r,align:a,style:s,onPress:l,getChildren:c,children:E,liveUpdate:x}=t;const[Le,j]=i.React.useReducer(function(m){return~m},0);return i.React.useEffect(function(){if(!x)return;const m=new Date().setMilliseconds(1e3);let W,X;return X=setTimeout(function(){j(),W=setInterval(j,1e3)},m-Date.now()),function(){clearTimeout(X),clearInterval(W)}},[]),i.React.createElement(A,{style:[e?J[e]:{},r?{color:ee(R.semanticColors[r])}:{},a?{textAlign:a}:{},s??{}],numberOfLines:n,onPress:l},c?.()??E)}const{showUserProfile:$}=o.findByProps("showUserProfile"),{fetchProfile:U}=o.findByProps("fetchProfile"),I=o.findByStoreName("UserStore");function re(t){let{userId:e,color:n,loadUsername:r,children:a}=t;const[s,l]=i.React.useState(!1);return i.React.useEffect(function(){return!s&&r&&(I.getUser(e)?l(I.getUser(e).username):U(e).then(function(c){return l(c.user.username)}))},[r]),i.React.createElement(b,{variant:"text-md/bold",color:n??"TEXT_NORMAL",onPress:function(){return I.getUser(e)?$({userId:e}):U(e).then(function(){return $({userId:e})})}},r?`@${s??"..."}`:a)}function ae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function se(t,e){return e.get?e.get.call(t):e.value}function oe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function F(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function D(t,e){var n=L(t,e,"get");return se(t,n)}function _(t,e,n){ae(t,e),e.set(t,n)}function M(t,e,n){var r=L(t,e,"set");return oe(t,r,n),n}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t,e,n){return e&&O(t.prototype,e),n&&O(t,n),t}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const{View:le}=u.General,{FormRow:P,FormSwitchRow:ce,FormDivider:ue}=u.Forms;var h;(function(t){t[t.Useful=0]="Useful",t[t.Fixes=1]="Fixes"})(h||(h={}));const de=[{category:h.Useful,title:"Useful",icon:g.getAssetIDByName("img_nitro_remixing")},{category:h.Fixes,title:"Fixes",icon:g.getAssetIDByName("debug")}];let fe=function(){function t(){F(this,t),d(this,"store",new Array)}return k(t,[{key:"add",value:function(e){this.store.push(e)}},{key:"unpatch",value:function(){this.store.forEach(function(e){return e()}),this.store.length=0}}]),t}();var N=new WeakMap,T=new WeakMap;let S=function(){function t(e){let{id:n,label:r,sublabel:a,category:s,icon:l,settings:c,extra:E,runner:x}=e;F(this,t),d(this,"id",void 0),d(this,"label",void 0),d(this,"sublabel",void 0),d(this,"category",void 0),d(this,"icon",void 0),d(this,"settings",void 0),d(this,"extra",void 0),_(this,N,{writable:!0,value:void 0}),_(this,T,{writable:!0,value:void 0}),d(this,"patches",new fe),this.id=n,this.label=r,this.sublabel=a,this.category=s,this.icon=l,this.settings=c,this.extra=E,M(this,N,x.onStart.bind(this)),M(this,T,x.onStop.bind(this))}return k(t,[{key:"storage",get:function(){return w.modules[this.id]}},{key:"init",value:function(){w.modules[this.id]??={enabled:!1,options:this.settings?Object.fromEntries(Object.entries(this.settings).map(function(e){let[n,r]=e;return[n,r.default]})):{}},this.storage.enabled?this.start():this.stop()}},{key:"exit",value:function(){this.storage.enabled&&this.stop()}},{key:"component",get:function(){var e=this;return function(){const[n,r]=i.React.useReducer(function(l){return~l},0),[a,s]=i.React.useState(!0);return i.React.createElement(i.React.Fragment,null,i.React.createElement(P,{label:e.label,subLabel:e.sublabel,leading:e.icon&&i.React.createElement(P.Icon,{source:e.icon}),trailing:i.React.createElement(P.Arrow,{style:{transform:[{rotate:`${a?180:90}deg`}]}}),onPress:function(){s(!a),i.ReactNative.LayoutAnimation.configureNext(i.ReactNative.LayoutAnimation.Presets.easeInEaseOut)}}),!a&&i.React.createElement(i.React.Fragment,null,i.React.createElement(ue,null),i.React.createElement(i.ReactNative.View,{style:{paddingHorizontal:15}},e.extra?.credits&&i.React.createElement(le,{style:{marginHorizontal:12,marginVertical:12}},i.React.createElement(b,{variant:"text-md/semibold",color:"TEXT_NORMAL"},"Additional credits go to:"," ",e.extra.credits.map(function(l,c,E){return i.React.createElement(i.React.Fragment,null,Number.isNaN(Number(l))?l:i.React.createElement(re,{userId:l,loadUsername:!0}),c!==E.length-1?", ":"")}))),i.React.createElement(ce,{label:"Enabled",onValueChange:function(){e.toggle(),r()},value:e.storage.enabled}))))}.bind(this)}},{key:"toggle",value:function(){this.storage.enabled&&this.stop(),this.storage.enabled=!this.storage.enabled,this.storage.enabled?this.start():this.stop()}},{key:"start",value:function(){D(this,N).call(this)}},{key:"stop",value:function(){D(this,T).call(this),this.patches.unpatch()}}]),t}();const he=o.findByProps("useIsCurrentUserEligibleForRemix"),ge=o.findByProps("uploadLocalFiles");var ye=new S({id:"freemix",label:"Freemix",sublabel:"Unlocks the Remix feature without nitro",category:h.Useful,icon:g.getAssetIDByName("img_nitro_remixing"),extra:{credits:["257109471589957632"]},runner:{onStart(){var t=this;["useIsCurrentUserEligibleForRemix","useIsRemixEnabledForMedia","useIsRemixEnabled"].forEach(function(e){return t.patches.add(f.after(e,he,function(){return!0}))}),this.patches.add(f.before("uploadLocalFiles",ge,function(e){return e.map(function(n){return n.items=n.items.map(function(r){return r.isRemix=!1,r.item.isRemix=!1,r}),n})}))},onStop(){}}});const pe=o.findByName("UserProfileRow",!1);var Re=new S({id:"no-invite-to-servers",label:"No Invite to Servers",sublabel:"Removes the 'Invite to Servers' button from profiles",category:h.Fixes,icon:g.getAssetIDByName("icon-invite"),runner:{onStart(){this.patches.add(f.after("default",pe,function(t,e){return t[0].label===i.i18n.Messages.GUILD_INVITE_CTA?i.React.createElement(i.React.Fragment):e}))},onStop(){}}});const{View:V}=u.General,ve=o.findByStoreName("UserStore"),y=o.findByStoreName("SpotifyStore"),{play:be,sync:z}=o.findByProps("play","sync"),Ee="https://cdn.discordapp.com/attachments/919655852724604978/1134238120771076226/listenAlong.png";function Se(t){let{button:e,activity:n,user:r}=t;const[a,s]=i.React.useReducer(function(c){return~c},0);i.React.useEffect(function(){return y.addChangeListener(s),function(){return y.removeChangeListener(s)}},[]);const l=i.React.createElement(u.Button,e);return y.getSyncingWith()?.userId===r.id||ve.getCurrentUser().id===r.id?l:i.React.createElement(i.React.Fragment,null,i.React.createElement(V,{style:{width:"100%",paddingRight:30+8}},l),i.React.createElement(V,{style:{position:"absolute",right:0}},i.React.createElement(u.Button,{size:"small",text:"",style:[e.style,{width:30}],renderIcon:function(){return i.React.createElement(i.ReactNative.Image,{source:{uri:Ee}})},onPress:function(){if(q.showToast("Syncing",g.getAssetIDByName("Check")),y.getActivity())z(n,r.id);else{be(n,r.id);const c=function(){y.removeChangeListener(c),z(n,r.id)};y.addChangeListener(c)}}})))}const{SpotifyPlayButton:we}=o.findByProps("SpotifyPlayButton"),xe=o.findByName("UserProfileSection",!1);var Ae=new S({id:"spotify-listen-along",label:"Add Listen Along",sublabel:"Adds a Listen Along button to Spotify activites",category:h.Useful,icon:g.getAssetIDByName("ic_music"),extra:{credits:["1034579679526526976"]},runner:{onStart(){var t=this;this.patches.add(f.after("render",we.prototype,function(e,n){const r=n?._owner?.stateNode?.props;if(!r?.activity?.user)return;const a=n.props;return React.createElement(Se,{button:a,activity:r.activity,user:r.activity.user})})),this.patches.add(f.before("default",xe,function(e){let[n]=e;if(n.title?.includes("Spotify")){const r=K.findInReactTree(n.children,function(a){return a?.type?.name==="Actions"});r&&t.patches.add(f.before("type",r,function(a){let[s]=a;return s.activity.user=s.user},!0))}}))},onStop(){}}});const Ie=o.findByProps("downloadMediaAsset"),Pe=o.findByProps("openLazy","hideActionSheet"),G=function(t){const e=t.split("/"),n=e.findIndex(function(l){return l.endsWith(".tenor.com")});if(n===-1)return;const[r,a,s]=e.slice(n,n+3);if(!(!r||!a||!s))return`https://${r}/${a.slice(0,-2)}AC/${s.split(".")[0]}.gif`};var Ne=new S({id:"tenor-gif-fix",label:"Tenor GIF Fix",sublabel:"Downloads Tenor links as GIFs instead of videos",category:h.Fixes,icon:g.getAssetIDByName("ic_gif_24px"),runner:{onStart(){this.patches.add(f.before("downloadMediaAsset",Ie,function(t){const e=t[0];if(!e||typeof e!="string")return;const n=G(e);n&&(t[0]=n,t[1]=1)})),this.patches.add(f.before("openLazy",Pe,function(t){const[e,n,r]=t;if(n!=="MediaShareActionSheet")return;const a=r?.syncer?.sources?.[0];if(!a||typeof a.uri!="string")return;const s=G(a.uri);s&&(a.uri=s,a.sourceURI=s,delete a.videoURI,delete a.isGIFV),r.syncer.sources[0]=a}))},onStop(){}}}),B=[ye,Ne,Ae,Re];const{Pressable:Te}=u.General,Be=o.findByStoreName("UserStore");function me(){const[t,e]=i.React.useState(0),[n,r]=i.React.useState(!1),a=i.React.useRef(new i.ReactNative.Animated.Value(0)).current;return i.React.useEffect(function(){i.ReactNative.Animated.timing(a,{toValue:t*(Math.PI/180),duration:4e3,easing:i.ReactNative.Easing.out(i.ReactNative.Easing.quad),useNativeDriver:!0}).start()},[t]),i.React.createElement(Te,{onPress:function(){return e(t+360*5)},style:{marginRight:12},onLongPress:function(){r(!n),i.ReactNative.LayoutAnimation.configureNext({duration:700})}},i.React.createElement(i.ReactNative.Animated.Image,{style:{height:85,width:85,borderRadius:18,transform:[{rotate:a}]},source:{uri:n?te(Be.getCurrentUser(),!0):"https://cdn.discordapp.com/attachments/919655852724604978/1131722678450004118/fish.gif"}}))}const{View:Ce,ScrollView:$e}=u.General;function Ue(){return React.createElement($e,null,React.createElement(Ce,{style:{marginHorizontal:20,marginTop:20,marginBottom:10,flexDirection:"row",justifyContent:"center",alignItems:"center"}},React.createElement(me,null),React.createElement(b,{variant:"text-lg/semibold",color:"TEXT_NORMAL"},"NexxUtils v",H)),de.map(function(t){let{category:e,title:n,icon:r}=t;const a=B.filter(function(s){return s.category===e});return React.createElement(ie,{title:n,icon:r,padding:a.length===0},a.length>0?a.map(function(s){return React.createElement(s.component,null)}):React.createElement(b,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:{fontStyle:"italic"}},`No plugins in the ${n} category yet!`))}))}const w=Y.storage,H="0.1.3";var Fe={onLoad:function(){w.modules??={},B.forEach(function(t){return t.init()})},onUnload:function(){return B.forEach(function(t){return t.exit()})},settings:Ue};return p.default=Fe,p.version=H,p.vstorage=w,Object.defineProperty(p,"__esModule",{value:!0}),p})({},vendetta.plugin,vendetta.ui.assets,vendetta.patcher,vendetta.metro,vendetta.metro.common,vendetta.ui.components,vendetta.ui,vendetta.ui.toasts,vendetta.utils);
