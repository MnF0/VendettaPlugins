(function(w,e,K,D,A,N,F,v,$,C){"use strict";const{TextStyleSheet:W}=v.findByProps("TextStyleSheet"),{View:k,Text:L,Pressable:J}=A.General,{FormRow:Q}=A.Forms;v.find(function(t){return t.render?.name==="ActionSheet"}),v.findByProps("openLazy","hideActionSheet"),v.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer");function Z(t){const f=v.findByProps("colors","meta"),i=v.findByStoreName("ThemeStore");return f.meta.resolveSemanticColor(i.theme,t)}function ee(t){let{title:f,onPress:i,icon:o}=t;const a=e.stylesheet.createThemedStyleSheet({androidRipple:{color:$.semanticColors.ANDROID_RIPPLE},mainText:{fontFamily:e.constants.Fonts.PRIMARY_SEMIBOLD,fontSize:14,includeFontPadding:!1,letterSpacing:void 0,lineHeight:18,textTransform:"none",color:$.semanticColors.HEADER_SECONDARY},icon:{height:14,tintColor:$.semanticColors.HEADER_SECONDARY}}),u=i?J:k;return e.React.createElement(u,{android_ripple:a.androidRipple,disabled:!1,accessibilityRole:"button",onPress:i,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},o&&e.React.createElement(k,{style:{marginRight:4}},e.React.createElement(Q.Icon,{style:a.icon,source:o,size:"small"})),e.React.createElement(L,{style:a.mainText},f))}function I(t){let{title:f,onTitlePress:i,icon:o,children:a,padding:u}=t;const l=e.stylesheet.createThemedStyleSheet({main:{backgroundColor:$.semanticColors.BACKGROUND_TERTIARY,borderRadius:16,overflow:"hidden",flex:1}});return e.React.createElement(k,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(ee,{title:f,onPress:i,icon:o}),e.React.createElement(k,{style:l.main},u?e.React.createElement(k,{style:{paddingHorizontal:16,paddingVertical:16}},a):a))}var B;(function(t){function f(o){let{children:a,onPress:u}=o;return e.React.createElement(y,{variant:"text-md/bold",onPress:u},a)}t.Bold=f;function i(o){let{children:a,onPress:u}=o;return e.React.createElement(L,{style:{textDecorationLine:"underline"},onPress:u},a)}t.Underline=i})(B||(B={}));function y(t){let{variant:f,lineClamp:i,color:o,align:a,style:u,onPress:l,getChildren:n,children:g,liveUpdate:d}=t;const[c,R]=e.React.useReducer(function(m){return~m},0);return e.React.useEffect(function(){if(!d)return;const m=new Date().setMilliseconds(1e3);let p,E;return E=setTimeout(function(){R(),p=setInterval(R,1e3)},m-Date.now()),function(){clearTimeout(E),clearInterval(p)}},[]),e.React.createElement(L,{style:[f?W[f]:{},o?{color:Z($.semanticColors[o])}:{},a?{textAlign:a}:{},u??{}],numberOfLines:i,onPress:l},n?.()??g)}const{parseTimestamp:q}=v.findByProps("parseTimestamp","unparseTimestamp"),_=e.stylesheet.createThemedStyleSheet({code:{fontFamily:e.constants.Fonts.CODE_SEMIBOLD,backgroundColor:$.semanticColors.BACKGROUND_SECONDARY},timestamp:{backgroundColor:$.semanticColors.BACKGROUND_MODIFIER_ACCENT}});function te(){const[t,f]=e.React.useState(Date.now());return e.React.useLayoutEffect(function(){return f(Date.now())},[r.time.acceptRelative]),e.React.createElement(y,{variant:"text-md/semibold",color:"TEXT_NORMAL",liveUpdate:!0,getChildren:function(){const i=new Date,o=[[4],[19,20],[4,18,2],i.getHours()<12&&[i.getHours()],[i.getHours(),i.getMinutes()],[i.getHours(),i.getMinutes(),i.getSeconds()]].filter(function(l){return!!l}),a=[];let u=-1;for(const[l,n,g]of o){u++;const d=new Date;d.setHours(l,n??0,g||0);let c=[d.getHours().toString(),n!==void 0&&d.getMinutes().toString().padStart(2,"0"),g!==void 0&&d.getSeconds().toString().padStart(2,"0")].filter(function(m){return!!m}).join(":");l<12&&(c+=" AM");const R=q(Math.floor(d.getTime()/1e3).toString(),d.getSeconds()===0?"t":"T");a.push(r.time.requireBackticks?e.React.createElement(y,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:_.code},c):c),a.push(" \u2014 "),a.push(e.React.createElement(y,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:_.timestamp,onPress:function(){return C.showToast(R.full,D.getAssetIDByName("ic_information_24px"))}},R.formatted)),u!==o.length-1&&a.push(`
`)}if(r.time.acceptRelative){a.push(`

`);const l=[["in 20 seconds",1e3*20],["8 minutes ago",-(1e3*60*8)]];u=-1;for(const[n,g]of l){const d=t+g,c=q(Math.floor(d/1e3).toString(),"R");a.push(r.time.requireBackticks?e.React.createElement(y,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:_.code},n):n),a.push(" \u2014 "),a.push(e.React.createElement(y,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:_.timestamp,onPress:function(){return C.showToast(c.full,D.getAssetIDByName("ic_information_24px"))}},c.formatted)),u!==l.length-1&&a.push(`
`)}}return a}})}const{parseTimestamp:H}=v.findByProps("parseTimestamp","unparseTimestamp"),x=e.stylesheet.createThemedStyleSheet({code:{fontFamily:e.constants.Fonts.CODE_SEMIBOLD,backgroundColor:$.semanticColors.BACKGROUND_SECONDARY},timestamp:{backgroundColor:$.semanticColors.BACKGROUND_MODIFIER_ACCENT}});function ae(){const[t,f]=e.React.useState(Date.now());return e.React.useLayoutEffect(function(){return f(Date.now())},[r.day.acceptRelative]),e.React.createElement(y,{variant:"text-md/semibold",color:"TEXT_NORMAL",liveUpdate:!0,getChildren:function(){const i=new Date,o=[[21,11,2023],[12,5],[1,8,20],[i.getDate(),i.getMonth()-1,i.getFullYear()],[i.getDate(),i.getMonth()-1],[i.getDate(),i.getMonth()-1,i.getFullYear()-2e3]].filter(function(l){return!!l}),a=[];let u=-1;for(let[l,n,g]of o){u++;const d=new Date().getFullYear(),c=new Date;g<100&&(g+=2e3),c.setFullYear(g??d,n,l);const R=H(Math.floor(c.getTime()/1e3).toString(),"d"),m=[r.day.american?n:l,r.day.american?l:n,g].join("/");a.push(r.day.requireBackticks?e.React.createElement(y,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:x.code},m):m),a.push(" \u2014 "),a.push(e.React.createElement(y,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:x.timestamp,onPress:function(){return C.showToast(R.full,D.getAssetIDByName("ic_information_24px"))}},R.formatted)),u!==o.length-1&&a.push(`
`)}if(r.day.acceptRelative){a.push(`

`);const l=1e3*60*60*24,n=l*(365+1/4),g=[["yesterday",-l],["in 2 days",l*2],["2 centuries ago",-(n*200)],["next week",l*7]];u=-1;for(const[d,c]of g){const R=t+c,m=H(Math.floor(R/1e3).toString(),"R");a.push(r.day.requireBackticks?e.React.createElement(y,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:x.code},d):d),a.push(" \u2014 "),a.push(e.React.createElement(y,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:x.timestamp,onPress:function(){return C.showToast(m.full,D.getAssetIDByName("ic_information_24px"))}},m.formatted)),u!==g.length-1&&a.push(`
`)}}return a}})}const{View:Y,ScrollView:ne}=A.General,{FormSwitchRow:O,FormIcon:P}=A.Forms,{BadgableTabBar:re}=v.findByProps("BadgableTabBar");function ie(){const[t,f]=e.React.useState("time");return r.time??={acceptRelative:!1,requireBackticks:N.storage.reqBackticks??!0},r.day??={acceptRelative:!1,requireBackticks:!0,american:!1},N.storage.alwaysLong!==void 0&&delete N.storage.alwaysLong,N.storage.reqBackticks!==void 0&&delete N.storage.reqBackticks,K.useProxy(r),e.React.createElement(ne,null,e.React.createElement(Y,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(re,{activeTab:t,onTabSelected:f,tabs:[{id:"day",title:"Date"},{id:"time",title:"Time"}]})),e.React.createElement(I,{title:"Info",icon:D.getAssetIDByName("ic_info_24px"),padding:!0},e.React.createElement(y,{variant:"text-md/semibold",color:"TEXT_NORMAL"},t==="time"?e.React.createElement(e.React.Fragment,null,"Send a message with a time code (in"," ",e.React.createElement(B.Bold,null,"HH:MM"),r.time.acceptRelative?", ":" or ",e.React.createElement(B.Bold,null,"HH:MM:SS"),r.time.acceptRelative&&e.React.createElement(e.React.Fragment,null," or relative")," format) and automatically turn it into a timestamp",`

`,e.React.createElement(te,null)):e.React.createElement(e.React.Fragment,null,"Send a message with a date code (in"," ",e.React.createElement(B.Bold,null,r.day.american?"MM/DD":"DD/MM","/YY(YY)"),r.day.acceptRelative?", ":" or ",e.React.createElement(B.Bold,null,r.day.american?"MM/DD":"DD/MM","/MM"),r.day.acceptRelative&&e.React.createElement(e.React.Fragment,null," or relative")," format) and automatically turn it into a timestamp",`

`,e.React.createElement(ae,null)))),e.React.createElement(I,{title:"Settings",icon:D.getAssetIDByName("settings")},e.React.createElement(O,{key:`${t}_acceptRelative`,label:`Allow Relative ${t==="time"?"Time":"Date"}`,subLabel:t==="time"?"Formats relative time (in 10 seconds, 5 minutes ago)":"Formats relative date (in 2 days, 6 weeks ago)",leading:e.React.createElement(P,{source:D.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return r[t].acceptRelative=!r[t].acceptRelative},value:r[t].acceptRelative}),e.React.createElement(O,{key:`${t}_requireBackticks`,label:"Require Backticks",subLabel:`Require ${t==="day"?"date":"time"} to be surrounded by backticks (\`)`,leading:e.React.createElement(P,{source:D.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return r[t].requireBackticks=!r[t].requireBackticks},value:r[t].requireBackticks}),t==="day"&&e.React.createElement(O,{key:`${t}_american`,label:"'Merican Dates",subLabel:"Uses MM/DD instead of DD/MM",leading:e.React.createElement(P,{source:D.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return r.day.american=!r.day.american},value:r.day.american})),e.React.createElement(Y,{style:{marginBottom:16}}))}function se(t,f,i,o){const a=[["seconds?",1e3],["minutes?",6e4],["hours?",36e5]],u=31556952e3,l=1e3*60*60*24,n=[["days?",l],["weeks?",l*7],["months?",l*30.436875],["years?",u],["decades?",u*10],["century",u*100],["centuries",u*100]],g=[...t.time?a:[],...t.date?n:[]].filter(function(s){return!!s}),d=function(s){return s?["`","`"]:["(?:\\s|\\t|^)","(?:\\s|\\t|$)"]},c=d(f.time),R=d(f.date),m=function(s){return`in (an?|[0-9]+) (${s})`},p=function(s){return`(an?|[0-9]+) (${s}) ago`},E=[t.time&&[1,`${c[0]}${m(a.map(function(s){return s[0]}).join("|"))}${c[1]}`],t.time&&[-1,`${c[0]}${p(a.map(function(s){return s[0]}).join("|"))}${c[1]}`],t.date&&[1,`${R[0]}${m(n.map(function(s){return s[0]}).join("|"))}${R[1]}`],t.date&&[-1,`${R[0]}${p(n.map(function(s){return s[0]}).join("|"))}${R[1]}`]].filter(function(s){return!!s});for(const[s,S]of E)i=i.replace(new RegExp(S,"gi"),function(b,G,le){const V=G.toLowerCase().startsWith("a")?1:Number(G);if(Number.isNaN(V))return b;const z=g.find(function(ue){return ue[0].toLowerCase().includes(le)})?.[1];return z?o(b,z*V*s):b});const h=[["last week",-7],["yesterday",-1],["tomorrow",1],["next week",7]].map(function(s){return[`${R[0]}${s[0]}${R[1]}`,s[1]*1e3*60*60*24]}),T=[...t.date?h:[]].filter(function(s){return!!s});for(const[s,S]of T)i=i.replace(new RegExp(s,"gi"),function(b){return o(b,S)});return i}const U=v.findByProps("sendMessage","editMessage"),M=function(t){return/^\s$/.test(t)},X=function(t){let[f,i]=t,o=i?.content;if(typeof o!="string"||typeof i!="object")return;const a=function(n){return n?["`","`"]:["(?:\\s|\\t|^)","(?:\\s|\\t|$)"]},u=a(r.time?.requireBackticks),l=a(r.day?.requireBackticks);if(r.time){const n={otN:"[0-9]{1,2}",tN:"[0-9]{2}",abrv:"(?: ?(AM|PM))"},g=[`(${n.otN}:${n.tN}:${n.tN})${n.abrv}?`,`(${n.otN}:${n.tN})${n.abrv}?`,`(${n.otN})${n.abrv}`].map(function(d){return new RegExp(`${u[0]}${d}${u[1]}`,"gi")});for(const d of g)o=o.replace(d,function(c,R,m){let[p,E,h]=R.split(":").map(function(s){return Number(s)});if(p<0||p>24||typeof E=="number"&&(E<0||E>60)||typeof h=="number"&&(h<0||h>60))return c;m&&(m.toLowerCase()==="pm"&&p!==12?p+=12:m.toLowerCase()==="am"&&p===12&&(p=0));const T=new Date;return T.setHours(p,E??0,h??0,0),`${M(c[0])?c[0]:""}<t:${Math.floor(T.getTime()/1e3)}:${T.getSeconds()===0?"t":"T"}>${M(c[c.length-1])?c[c.length-1]:""}`})}if(r.day){const n={otN:"[0-9]{1,2}",tN:"[0-9]{2}",fN:"[0-9]{4}"},g=[`(${n.otN})\\/(${n.otN})\\/(${n.fN}|${n.tN})`,`(${n.otN})\\/(${n.otN})`].map(function(d){return new RegExp(`${l[0]}${d}${l[1]}`,"gi")});for(const d of g)o=o.replace(d,function(c,R,m,p){const E=new Date().getFullYear();let[h,T,s]=[Number(R),Number(m),p?Number(p):E];if(r.day.american){const b=T;T=h,h=b}if(h<0||h>31||T<0||T>12||s<0||s>9999)return c;s<100&&(s+=2e3);const S=new Date(0);return S.setFullYear(s,T-1,h),`${M(c[0])?c[0]:""}<t:${Math.floor(S.getTime()/1e3)}:d>${M(c[c.length-1])?c[c.length-1]:""}`})}o=se({time:!!r.time?.acceptRelative,date:!!r.day?.acceptRelative},{time:!!r.time?.requireBackticks,date:!!r.day?.requireBackticks},o,function(n,g){return`${M(n[0])?n[0]:""}<t:${Math.floor((Date.now()+g)/1e3)}:R>${M(n[n.length-1])?n[0]:""}`}),i.content=o};function ce(){const t=new Array;return t.push(F.before("sendMessage",U,X)),t.push(F.before("editMessage",U,X)),function(){return t.forEach(function(f){return f()})}}const r=N.storage;let j;var oe={onLoad:function(){return j=ce()},onUnload:function(){return j?.()},settings:ie};return w.default=oe,w.vstorage=r,Object.defineProperty(w,"__esModule",{value:!0}),w})({},vendetta.metro.common,vendetta.storage,vendetta.ui.assets,vendetta.ui.components,vendetta.plugin,vendetta.patcher,vendetta.metro,vendetta.ui,vendetta.ui.toasts);
