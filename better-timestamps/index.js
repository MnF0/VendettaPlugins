(function(w,e,K,D,C,b,F,y,N,A){"use strict";const{TextStyleSheet:W}=y.findByProps("TextStyleSheet"),{View:k,Text:P,Pressable:J}=C.General,{FormRow:Q}=C.Forms;y.find(function(t){return t.render?.name==="ActionSheet"}),y.findByProps("openLazy","hideActionSheet"),y.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer"),y.findByName("Navigator"),y.findByProps("getRenderCloseButton"),y.findByProps("popModal","pushModal");function Z(t){const f=y.findByProps("colors","meta"),i=y.findByStoreName("ThemeStore");return f.meta.resolveSemanticColor(i.theme,t)}function ee(t){let{title:f,onPress:i,icon:o}=t;const a=e.stylesheet.createThemedStyleSheet({androidRipple:{color:N.semanticColors.ANDROID_RIPPLE},mainText:{fontFamily:e.constants.Fonts.PRIMARY_SEMIBOLD,fontSize:14,includeFontPadding:!1,letterSpacing:void 0,lineHeight:18,textTransform:"none",color:N.semanticColors.HEADER_SECONDARY},icon:{height:14,tintColor:N.semanticColors.HEADER_SECONDARY}}),l=i?J:k;return e.React.createElement(l,{android_ripple:a.androidRipple,disabled:!1,accessibilityRole:"button",onPress:i,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},o&&e.React.createElement(k,{style:{marginRight:4}},e.React.createElement(Q.Icon,{style:a.icon,source:o,size:"small"})),e.React.createElement(P,{style:a.mainText},f))}function I(t){let{title:f,onTitlePress:i,icon:o,children:a,padding:l}=t;const u=e.stylesheet.createThemedStyleSheet({main:{backgroundColor:N.semanticColors.BACKGROUND_TERTIARY,borderRadius:16,overflow:"hidden",flex:1}});return e.React.createElement(k,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(ee,{title:f,onPress:i,icon:o}),e.React.createElement(k,{style:u.main},l?e.React.createElement(k,{style:{paddingHorizontal:16,paddingVertical:16}},a):a))}var B;(function(t){function f(o){let{children:a,onPress:l}=o;return e.React.createElement(h,{variant:"text-md/bold",onPress:l},a)}t.Bold=f;function i(o){let{children:a,onPress:l}=o;return e.React.createElement(P,{style:{textDecorationLine:"underline"},onPress:l},a)}t.Underline=i})(B||(B={}));function h(t){let{variant:f,lineClamp:i,color:o,align:a,style:l,onPress:u,getChildren:n,children:g,liveUpdate:d}=t;const[c,R]=e.React.useReducer(function(p){return~p},0);return e.React.useEffect(function(){if(!d)return;const p=new Date().setMilliseconds(1e3);let m,T;return T=setTimeout(function(){R(),m=setInterval(R,1e3)},p-Date.now()),function(){clearTimeout(T),clearInterval(m)}},[]),e.React.createElement(P,{style:[f?W[f]:{},o?{color:Z(N.semanticColors[o])}:{},a?{textAlign:a}:{},l??{}],numberOfLines:i,onPress:u},n?.()??g)}const{parseTimestamp:q}=y.findByProps("parseTimestamp","unparseTimestamp"),_=e.stylesheet.createThemedStyleSheet({code:{fontFamily:e.constants.Fonts.CODE_SEMIBOLD,backgroundColor:N.semanticColors.BACKGROUND_SECONDARY},timestamp:{backgroundColor:N.semanticColors.BACKGROUND_MODIFIER_ACCENT}});function te(){const[t,f]=e.React.useState(Date.now());return e.React.useLayoutEffect(function(){return f(Date.now())},[r.time.acceptRelative]),e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",liveUpdate:!0,getChildren:function(){const i=new Date,o=[[4],[19,20],[4,18,2],i.getHours()<12&&[i.getHours()],[i.getHours(),i.getMinutes()],[i.getHours(),i.getMinutes(),i.getSeconds()]].filter(function(u){return!!u}),a=[];let l=-1;for(const[u,n,g]of o){l++;const d=new Date;d.setHours(u,n??0,g||0);let c=[d.getHours().toString(),n!==void 0&&d.getMinutes().toString().padStart(2,"0"),g!==void 0&&d.getSeconds().toString().padStart(2,"0")].filter(function(p){return!!p}).join(":");u<12&&(c+=" AM");const R=q(Math.floor(d.getTime()/1e3).toString(),d.getSeconds()===0?"t":"T");a.push(r.time.requireBackticks?e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:_.code},c):c),a.push(" \u2014 "),a.push(e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:_.timestamp,onPress:function(){return A.showToast(R.full,D.getAssetIDByName("ic_information_24px"))}},R.formatted)),l!==o.length-1&&a.push(`
`)}if(r.time.acceptRelative){a.push(`

`);const u=[["in 20 seconds",1e3*20],["8 minutes ago",-(1e3*60*8)]];l=-1;for(const[n,g]of u){const d=t+g,c=q(Math.floor(d/1e3).toString(),"R");a.push(r.time.requireBackticks?e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:_.code},n):n),a.push(" \u2014 "),a.push(e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:_.timestamp,onPress:function(){return A.showToast(c.full,D.getAssetIDByName("ic_information_24px"))}},c.formatted)),l!==u.length-1&&a.push(`
`)}}return a}})}const{parseTimestamp:H}=y.findByProps("parseTimestamp","unparseTimestamp"),x=e.stylesheet.createThemedStyleSheet({code:{fontFamily:e.constants.Fonts.CODE_SEMIBOLD,backgroundColor:N.semanticColors.BACKGROUND_SECONDARY},timestamp:{backgroundColor:N.semanticColors.BACKGROUND_MODIFIER_ACCENT}});function ae(){const[t,f]=e.React.useState(Date.now());return e.React.useLayoutEffect(function(){return f(Date.now())},[r.day.acceptRelative]),e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",liveUpdate:!0,getChildren:function(){const i=new Date,o=[[21,11,2023],[12,5],[1,8,20],[i.getDate(),i.getMonth()-1,i.getFullYear()],[i.getDate(),i.getMonth()-1],[i.getDate(),i.getMonth()-1,i.getFullYear()-2e3]].filter(function(u){return!!u}),a=[];let l=-1;for(let[u,n,g]of o){l++;const d=new Date().getFullYear(),c=new Date;g<100&&(g+=2e3),c.setFullYear(g??d,n,u);const R=H(Math.floor(c.getTime()/1e3).toString(),"d"),p=[r.day.american?n:u,r.day.american?u:n,g].join("/");a.push(r.day.requireBackticks?e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:x.code},p):p),a.push(" \u2014 "),a.push(e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:x.timestamp,onPress:function(){return A.showToast(R.full,D.getAssetIDByName("ic_information_24px"))}},R.formatted)),l!==o.length-1&&a.push(`
`)}if(r.day.acceptRelative){a.push(`

`);const u=1e3*60*60*24,n=u*(365+1/4),g=[["yesterday",-u],["in 2 days",u*2],["2 centuries ago",-(n*200)],["next week",u*7]];l=-1;for(const[d,c]of g){const R=t+c,p=H(Math.floor(R/1e3).toString(),"R");a.push(r.day.requireBackticks?e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:x.code},d):d),a.push(" \u2014 "),a.push(e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL",style:x.timestamp,onPress:function(){return A.showToast(p.full,D.getAssetIDByName("ic_information_24px"))}},p.formatted)),l!==g.length-1&&a.push(`
`)}}return a}})}const{View:Y,ScrollView:ne}=C.General,{FormSwitchRow:L,FormIcon:O}=C.Forms,{BadgableTabBar:re}=y.findByProps("BadgableTabBar");function ie(){const[t,f]=e.React.useState("time");return r.time??={acceptRelative:!1,requireBackticks:b.storage.reqBackticks??!0},r.day??={acceptRelative:!1,requireBackticks:!0,american:!1},b.storage.alwaysLong!==void 0&&delete b.storage.alwaysLong,b.storage.reqBackticks!==void 0&&delete b.storage.reqBackticks,K.useProxy(r),e.React.createElement(ne,null,e.React.createElement(Y,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(re,{activeTab:t,onTabSelected:f,tabs:[{id:"day",title:"Date"},{id:"time",title:"Time"}]})),e.React.createElement(I,{title:"Info",icon:D.getAssetIDByName("ic_info_24px"),padding:!0},e.React.createElement(h,{variant:"text-md/semibold",color:"TEXT_NORMAL"},t==="time"?e.React.createElement(e.React.Fragment,null,"Send a message with a time code (in"," ",e.React.createElement(B.Bold,null,"HH:MM"),r.time.acceptRelative?", ":" or ",e.React.createElement(B.Bold,null,"HH:MM:SS"),r.time.acceptRelative&&e.React.createElement(e.React.Fragment,null," or relative")," format) and automatically turn it into a timestamp",`

`,e.React.createElement(te,null)):e.React.createElement(e.React.Fragment,null,"Send a message with a date code (in"," ",e.React.createElement(B.Bold,null,r.day.american?"MM/DD":"DD/MM","/YY(YY)"),r.day.acceptRelative?", ":" or ",e.React.createElement(B.Bold,null,r.day.american?"MM/DD":"DD/MM","/MM"),r.day.acceptRelative&&e.React.createElement(e.React.Fragment,null," or relative")," format) and automatically turn it into a timestamp",`

`,e.React.createElement(ae,null)))),e.React.createElement(I,{title:"Settings",icon:D.getAssetIDByName("settings")},e.React.createElement(L,{key:`${t}_acceptRelative`,label:`Allow Relative ${t==="time"?"Time":"Date"}`,subLabel:t==="time"?"Formats relative time (in 10 seconds, 5 minutes ago)":"Formats relative date (in 2 days, 6 weeks ago)",leading:e.React.createElement(O,{source:D.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return r[t].acceptRelative=!r[t].acceptRelative},value:r[t].acceptRelative}),e.React.createElement(L,{key:`${t}_requireBackticks`,label:"Require Backticks",subLabel:`Require ${t==="day"?"date":"time"} to be surrounded by backticks (\`)`,leading:e.React.createElement(O,{source:D.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return r[t].requireBackticks=!r[t].requireBackticks},value:r[t].requireBackticks}),t==="day"&&e.React.createElement(L,{key:`${t}_american`,label:"'Merican Dates",subLabel:"Uses MM/DD instead of DD/MM",leading:e.React.createElement(O,{source:D.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return r.day.american=!r.day.american},value:r.day.american})),e.React.createElement(Y,{style:{marginBottom:16}}))}function se(t,f,i,o){const a=[["seconds?",1e3],["minutes?",6e4],["hours?",36e5]],l=31556952e3,u=1e3*60*60*24,n=[["days?",u],["weeks?",u*7],["months?",u*30.436875],["years?",l],["decades?",l*10],["century",l*100],["centuries",l*100],["millennium",l*1e3],["millennia",l*1e3]],g=[...t.time?a:[],...t.date?n:[]].filter(function(s){return!!s}),d=function(s){return s?["`","`"]:["(?:\\s|\\t|^)","(?:\\s|\\t|$)"]},c=d(f.time),R=d(f.date),p=function(s){return`in (an?|[0-9]+) (${s})`},m=function(s){return`(an?|[0-9]+) (${s}) ago`},T=[t.time&&[1,`${c[0]}${p(a.map(function(s){return s[0]}).join("|"))}${c[1]}`],t.time&&[-1,`${c[0]}${m(a.map(function(s){return s[0]}).join("|"))}${c[1]}`],t.date&&[1,`${R[0]}${p(n.map(function(s){return s[0]}).join("|"))}${R[1]}`],t.date&&[-1,`${R[0]}${m(n.map(function(s){return s[0]}).join("|"))}${R[1]}`]].filter(function(s){return!!s});for(const[s,S]of T)i=i.replace(new RegExp(S,"gi"),function($,G,le){const V=G.toLowerCase().startsWith("a")?1:Number(G);if(Number.isNaN(V))return $;const z=g.find(function(ue){return ue[0].toLowerCase().includes(le)})?.[1];return z?o($,z*V*s):$});const E=[["last week",-7],["yesterday",-1],["tomorrow",1],["next week",7]].map(function(s){return[`${R[0]}${s[0]}${R[1]}`,s[1]*1e3*60*60*24]}),v=[...t.date?E:[]].filter(function(s){return!!s});for(const[s,S]of v)i=i.replace(new RegExp(s,"gi"),function($){return o($,S)});return i}const U=y.findByProps("sendMessage","editMessage"),M=function(t){return/^\s$/.test(t)},X=function(t){let[f,i]=t,o=i?.content;if(typeof o!="string"||typeof i!="object")return;const a=function(n){return n?["`","`"]:["(?:\\s|\\t|^)","(?:\\s|\\t|$)"]},l=a(r.time?.requireBackticks),u=a(r.day?.requireBackticks);if(r.time){const n={otN:"[0-9]{1,2}",tN:"[0-9]{2}",abrv:"(?: ?(AM|PM))"},g=[`(${n.otN}:${n.tN}:${n.tN})${n.abrv}?`,`(${n.otN}:${n.tN})${n.abrv}?`,`(${n.otN})${n.abrv}`].map(function(d){return new RegExp(`${l[0]}${d}${l[1]}`,"gi")});for(const d of g)o=o.replace(d,function(c,R,p){let[m,T,E]=R.split(":").map(function(s){return Number(s)});if(m<0||m>24||typeof T=="number"&&(T<0||T>60)||typeof E=="number"&&(E<0||E>60))return c;p&&(p.toLowerCase()==="pm"&&m!==12?m+=12:p.toLowerCase()==="am"&&m===12&&(m=0));const v=new Date;return v.setHours(m,T??0,E??0,0),`${M(c[0])?c[0]:""}<t:${Math.floor(v.getTime()/1e3)}:${v.getSeconds()===0?"t":"T"}>${M(c[c.length-1])?c[c.length-1]:""}`})}if(r.day){const n={otN:"[0-9]{1,2}",tN:"[0-9]{2}",fN:"[0-9]{4}"},g=[`(${n.otN})\\/(${n.otN})\\/(${n.fN}|${n.tN})`,`(${n.otN})\\/(${n.otN})`].map(function(d){return new RegExp(`${u[0]}${d}${u[1]}`,"gi")});for(const d of g)o=o.replace(d,function(c,R,p,m){const T=new Date().getFullYear();let[E,v,s]=[Number(R),Number(p),m?Number(m):T];if(r.day.american){const $=v;v=E,E=$}if(E<0||E>31||v<0||v>12||s<0||s>9999)return c;s<100&&(s+=2e3);const S=new Date(0);return S.setFullYear(s,v-1,E),`${M(c[0])?c[0]:""}<t:${Math.floor(S.getTime()/1e3)}:d>${M(c[c.length-1])?c[c.length-1]:""}`})}o=se({time:!!r.time?.acceptRelative,date:!!r.day?.acceptRelative},{time:!!r.time?.requireBackticks,date:!!r.day?.requireBackticks},o,function(n,g){return`${M(n[0])?n[0]:""}<t:${Math.floor((Date.now()+g)/1e3)}:R>${M(n[n.length-1])?n[0]:""}`}),i.content=o};function ce(){const t=new Array;return t.push(F.before("sendMessage",U,X)),t.push(F.before("editMessage",U,X)),function(){return t.forEach(function(f){return f()})}}const r=b.storage;let j;var oe={onLoad:function(){return j=ce()},onUnload:function(){return j?.()},settings:ie};return w.default=oe,w.vstorage=r,Object.defineProperty(w,"__esModule",{value:!0}),w})({},vendetta.metro.common,vendetta.storage,vendetta.ui.assets,vendetta.ui.components,vendetta.plugin,vendetta.patcher,vendetta.metro,vendetta.ui,vendetta.ui.toasts);
