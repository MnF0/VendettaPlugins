(function(C,z,c,b,I,e,y,H,F,u,x){"use strict";const G=c.findByStoreName("UserStore");function D(t){return s.commas?t.toString().split("").reverse().map(function(r,a,i){return a%3===0&&i.length>3&&a!==0?`${r},`:r}).reverse().join(""):t.toString()}function U(){return!!(s.supportSLM&&Object.values(H.plugins).find(function(t){return t.manifest.name==="SplitLargeMessages"})?.enabled)}function Y(){return G.getCurrentUser()?.premiumType===2?4e3:2e3}const{Animated:P}=e.ReactNative;function B(t){let{duration:r,children:a,style:i,fade:n,trigger:o,customOpacity:l,setDisplay:R,animateOnInit:p}=t;p??=!0;const h=e.React.useRef(!0),f=e.React.useRef(!0),d=e.React.useRef(new P.Value(p&&n==="in"?1:0)).current;return e.React.useEffect(function(){if(!p&&h.current){h.current=!1;return}!p&&f.current&&(d.setValue(n==="in"?0:1),f.current=!1),P.timing(d,{toValue:l??(n==="in"?1:0),duration:r,useNativeDriver:!0}).start()},[d,n,l,o]),e.React.createElement(P.View,{style:[{opacity:d},R&&d._value===0&&{display:"none"},i]},a)}const{TextStyleSheet:$}=c.findByProps("TextStyleSheet"),{View:m,Text:N,Pressable:j}=y.General,{FormRow:X}=y.Forms;c.find(function(t){return t.render?.name==="ActionSheet"}),c.findByProps("openLazy","hideActionSheet"),c.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer");function k(t){const r=c.findByProps("colors","meta"),a=c.findByStoreName("ThemeStore");return r.meta.resolveSemanticColor(a.theme,t)}function K(t){let{title:r,onPress:a,icon:i}=t;const n=e.stylesheet.createThemedStyleSheet({androidRipple:{color:u.semanticColors.ANDROID_RIPPLE},mainText:{fontFamily:e.constants.Fonts.PRIMARY_SEMIBOLD,fontSize:14,includeFontPadding:!1,letterSpacing:void 0,lineHeight:18,textTransform:"none",color:u.semanticColors.HEADER_SECONDARY},icon:{height:14,tintColor:u.semanticColors.HEADER_SECONDARY}}),o=a?j:m;return e.React.createElement(o,{android_ripple:n.androidRipple,disabled:!1,accessibilityRole:"button",onPress:a,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},i&&e.React.createElement(m,{style:{marginRight:4}},e.React.createElement(X.Icon,{style:n.icon,source:i,size:"small"})),e.React.createElement(N,{style:n.mainText},r))}function W(t){let{title:r,onTitlePress:a,icon:i,children:n,padding:o}=t;const l=e.stylesheet.createThemedStyleSheet({main:{backgroundColor:u.semanticColors.BACKGROUND_TERTIARY,borderRadius:16,overflow:"hidden",flex:1}});return e.React.createElement(m,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(K,{title:r,onPress:a,icon:i}),e.React.createElement(m,{style:l.main},o?e.React.createElement(m,{style:{paddingHorizontal:16,paddingVertical:16}},n):n))}var M;(function(t){function r(i){let{children:n,onPress:o}=i;return e.React.createElement(_,{variant:"text-md/bold",onPress:o},n)}t.Bold=r;function a(i){let{children:n,onPress:o}=i;return e.React.createElement(N,{style:{textDecorationLine:"underline"},onPress:o},n)}t.Underline=a})(M||(M={}));function _(t){let{variant:r,lineClamp:a,color:i,align:n,style:o,onPress:l,getChildren:R,children:p,liveUpdate:h}=t;const[f,d]=e.React.useReducer(function(g){return~g},0);return e.React.useEffect(function(){if(!h)return;const g=new Date().setMilliseconds(1e3);let A,V;return V=setTimeout(function(){d(),A=setInterval(d,1e3)},g-Date.now()),function(){clearTimeout(V),clearInterval(A)}},[]),e.React.createElement(N,{style:[r?$[r]:{},i?{color:k(u.semanticColors[i])}:{},n?{textAlign:n}:{},o??{}],numberOfLines:a,onPress:l},R?.()??p)}const{Text:oe,View:J,Pressable:q}=y.General,{TextStyleSheet:w}=c.findByProps("TextStyleSheet"),S=w["text-xs/semibold"].fontSize,T=e.stylesheet.createThemedStyleSheet({androidRipple:{color:u.semanticColors.ANDROID_RIPPLE,cornerRadius:8},container:{backgroundColor:u.semanticColors.BACKGROUND_TERTIARY,borderRadius:8,marginRight:8,marginTop:-12},text:{...w["text-xs/semibold"],textAlign:"right",paddingHorizontal:8,paddingVertical:8},extraMessagesCircle:{backgroundColor:u.semanticColors.REDESIGN_BUTTON_PRIMARY_BACKGROUND,borderRadius:2147483647,position:"absolute",left:0,top:0,transform:[{translateX:-S},{translateY:-S}],minWidth:S*2,height:S*2,justifyContent:"center",alignItems:"center",zIndex:2},normal:{color:u.semanticColors.TEXT_NORMAL},jinkies:{color:u.semanticColors.TEXT_DANGER}});function Q(t){let{inputProps:r}=t;const[a,i]=e.React.useState(!1),n=e.React.useRef(null);r.onChangeText?b.after("onChangeText",r,function(g){let[A]=g;return n.current=A},!0):r.onChangeText=function(g){return n.current=g};const o=n.current?.length??0,l=Y(),R=U()?Math.floor(o/l):0,p=o-R*l,h=T.text.fontSize*2+T.text.paddingVertical,f=o>=(s.minChars??1),d=f?q:J;return e.React.createElement(B,{duration:100,style:{flexDirection:"row-reverse",position:"absolute",right:0,top:-h,zIndex:1},fade:f?"in":"out",customOpacity:a&&f?.3:void 0},e.React.createElement(d,{android_ripple:T.androidRipple,disabled:!1,accessibilityRole:"button",accessibilityState:{disabled:!1,expanded:!1},accessibilityLabel:"Character counter",accessibilityHint:"Tap to toggle character counter translucency",style:T.container,onPress:f?function(){return i(!a)}:void 0},e.React.createElement(B,{fade:R>0&&f?"in":"out",duration:100,style:T.extraMessagesCircle},e.React.createElement(_,{variant:"text-xs/semibold",color:"TEXT_NORMAL",style:{paddingHorizontal:S/2}},R)),e.React.createElement(_,{variant:"text-xs/semibold",color:p<=l?"TEXT_NORMAL":"TEXT_DANGER",style:{paddingHorizontal:8,paddingVertical:8}},D(p),"/",D(l))))}const{ChatInput:Z}=c.findByProps("ChatInput"),{MessagesWrapper:ee}=c.findByProps("MessagesWrapper");let E=[];function te(){return E.push(b.after("render",Z.prototype,function(t,r){let[a]=t;console.log(a?.focused);const i=I.findInReactTree(r.props.children,function(o){return o?.type?.name==="ChatInput"});if(!i?.props?.onChangeText)return;const n=I.findInReactTree(r.props.children,function(o){return o?.type?.displayName==="View"&&Array.isArray(o?.props?.children)})?.props?.children;n&&n.unshift(React.createElement(Q,{inputProps:i.props}))})),E.push(b.after("render",ee.prototype,function(t,r){const a=I.findInReactTree(r,function(i){return i?.type?.name==="JumpToPresentButton"});a&&E.push(b.after("type",a,function(i,n){n?.props?.style&&(n.props.style[1].bottom+=32+8)}))})),function(){E.forEach(function(t){return t()}),E=[]}}const{ScrollView:ne}=y.General,{FormSwitchRow:L,FormRadioRow:se,FormRow:v,FormInput:re}=y.Forms;function ae(){return s.position??="pill",s.commas??=!0,s.minChars??=1,s.supportSLM??=!0,F.useProxy(s),React.createElement(ne,null,React.createElement(W,{title:"Settings",icon:x.getAssetIDByName("ic_cog_24px")},React.createElement(v,{label:"Minimum Characters",subLabel:"The minimum amount of characters for Char Counter to show up",leading:React.createElement(v.Icon,{source:x.getAssetIDByName("ic_message_edit")})}),React.createElement(re,{title:"",keyboardType:"numeric",placeholder:"1",value:s.minChars.toString(),onChange:function(t){return s.minChars=Math.max(Number.isNaN(Number(t))?1:Number(t),1)},style:{marginTop:-25,marginHorizontal:12}}),React.createElement(L,{label:"Add Thousand Seperators",subLabel:"Adds thousand seperators (1,234,567) to numbers",leading:React.createElement(v.Icon,{source:x.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return s.commas=!s.commas},value:s.commas}),React.createElement(L,{label:"Support SplitLargeMessages",leading:React.createElement(v.Icon,{source:x.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return s.supportSLM=!s.supportSLM},value:s.supportSLM})))}const s=z.storage;let O;var ie={onLoad:function(){return O=te()},onUnload:function(){return O?.()},settings:ae};return C.default=ie,C.vstorage=s,Object.defineProperty(C,"__esModule",{value:!0}),C})({},vendetta.plugin,vendetta.metro,vendetta.patcher,vendetta.utils,vendetta.metro.common,vendetta.ui.components,vendetta.plugins,vendetta.storage,vendetta.ui,vendetta.ui.assets);
